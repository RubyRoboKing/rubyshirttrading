<!DOCTYPE HTML>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Inventory Table</title>
    <link href="https://fonts.googleapis.com/css2?display=swap&family=Lexend:wght@400;700&family=Rubik:wght@400;700" rel="stylesheet" />
    <link rel="stylesheet" href="assets/main.css" />
    <link rel="stylesheet" href="assets/tablestyle.css" />
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        function init() {
            gapi.load('client', start);
        }

        function start() {
            gapi.client.init({
                apiKey: AIzaSyB6vx_mNL4qc0JGVJR4ioUI-ojbJ2CcnIY, // Replace with your API Key
            }).then(() => {
                gapi.client.load('sheets', 'v4', () => {
                    loadSheetData();
                });
            });
        }

        function loadSheetData() {
            const spreadsheetId = 1038462381; // Replace with your Google Sheets ID
            const range = 'Sheet1!A2:J'; // Adjust sheet name and range as needed

            gapi.client.sheets.spreadsheets.values.get({
                spreadsheetId: spreadsheetId,
                range: range,
            }).then(response => {
                const data = response.result.values;
                populateTable(data);
            }).catch(error => {
                console.error('Error fetching sheet data:', error);
            });
        }

        function populateTable(data) {
            const table = document.getElementById('shirtTable').getElementsByTagName('tbody')[0];

            data.forEach(row => {
                if (row[0]) { // Check if the row has a team number
                    const sizeMap = {
                        'S': 'Small', 'M': 'Medium', 'L': 'Large', 'XL': 'X-Large',
                        'XXL': '2XL', 'XXXL': '3XL', 'XXXXL': '4XL', 'XXXXX': '5XL', 'XXXXXX': '6XL'
                    };
                    const size = sizeMap[row[3]] || row[3];
                    const highlightedClass = row[9] === 'TRUE' ? 'highlighted' : '';

                    const newRow = table.insertRow();
                    newRow.className = highlightedClass;

                    newRow.insertCell().innerHTML = `<img src="${row[1]}" alt="Team Icon" width="50">`;
                    newRow.insertCell().textContent = row[0];
                    newRow.insertCell().textContent = row[2];
                    newRow.insertCell().textContent = size;
                    newRow.insertCell().textContent = row[4];
                    newRow.insertCell().textContent = row[5];
                    newRow.insertCell().textContent = row[7];
                    newRow.insertCell().textContent = row[8];
                }
            });
        }

        window.onload = init;
    </script>
</head>
<body>
    <div id="wrapper">
        <div id="main">
            <div class="inner">
                <table id="shirtTable">
                    <thead>
                        <tr>
                            <th>Team Icon</th>
                            <th>Team Number</th>
                            <th>Team Name</th>
                            <th>Size</th>
                            <th>Type</th>
                            <th>Year</th>
                            <th>Tradability</th>
                            <th>Notes</th>
                        </tr>
                    </thead>
                    <tbody>
                        <!-- Table rows will be populated here by JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</body>
</html>
